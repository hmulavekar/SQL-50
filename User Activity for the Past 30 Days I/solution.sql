SELECT TO_CHAR(A.ACTIVITY_DATE,'YYYY-MM-DD') AS "DAY" , COUNT(DISTINCT(A.USER_ID)) AS "active_users" FROM ACTIVITY A  WHERE A.ACTIVITY_DATE BETWEEN TO_DATE('2019-07-28', 'YYYY-MM-DD') - 30 AND TO_DATE('2019-07-28', 'YYYY-MM-DD') GROUP BY A.ACTIVITY_DATE ORDER BY DAY;