SELECT Q.QUERY_NAME, ROUND(AVG(Q.RATING/Q.POSITION),2) AS "quality", ROUND(SUM(CASE WHEN Q.RATING<3 THEN 1 ELSE 0 END ) * 100 / COUNT(*),2) as "poor_query_percentage" FROM QUERIES Q  GROUP BY Q.QUERY_NAME   ;
